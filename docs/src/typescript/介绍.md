# 介绍

## TypeScript 

TypeScript 是一种由微软开发的自由和开源的编程语言。它是 JavaScript 的一个超集，而且本质上向这个语言添加了可选的静态类型和基于类的面向对象编程。

TypeScript 提供最新的和不断发展的 JavaScript 特性，包括那些来自 2015 年的 ECMAScript 和未来的提案中的特性，比如异步功能和 Decorators，以帮助建立健壮的组件。下图显示了 TypeScript 与 ES5、ES2015 和 ES2016 之间的关系

TypeScriptJavaScriptJavaScript 的超集用于解决大型项目的代码复杂性一种脚本语言，用于创建动态网页。可以在编译期间发现并纠正错误作为一种解释型语言，只能在运行时发现错误强类型，支持静态和动态类型弱类型，没有静态类型选项最终被编译成 JavaScript 代码，使浏览器可以理解可以直接在浏览器中使用支持模块、泛型和接口不支持模块，泛型或接口支持 ES3，ES4，ES5 和 ES6 等不支持编译其他 ES3，ES4，ES5 或 ES6 功能社区的支持仍在增长，而且还不是很大大量的社区支持以及大量文档和解决问题的支持

## Why TypeScript

> 一个复杂软件的常规研发流程，大致分为定义问题、需求分析、规划构建、软件架构、详细设计、编码调试、单元测试、集成测试、集成、系统测试、保障维护。构建活动（主要是编码调试）在中大型项目中的工作量占比大于50%。同时，一个中大型项目，bug由构建阶段引起的比例占到50%~75%，对于一个成功的项目来说，构建活动是必须要做的，而且是工程师更为可控的。

目标：生命周期较长（常常持续几年）的复杂SPA应用，保障开发效率的同时提升代码的可维护性和线上运行时质量。

- 从开发效率上看，虽然需要多写一些类型定义代码，但TS在VSCode、WebStorm等IDE下可以做到智能提示，智能感知bug，同时我们项目常用的一些第三方类库框架都有TS类型声明，我们也可以给那些没有TS类型声明的稳定模块写声明文件，如我们的前端KOP框架(目前还是蚂蚁内部框架，类比dva)，这在团队协作项目中可以提升整体的开发效率

- 从可维护性上看，长期迭代维护的项目开发和维护的成员会有很多，团队成员水平会有差异，而软件具有熵的特质，长期迭代维护的项目总会遇到可维护性逐渐降低的问题，有了强类型约束和静态检查，以及智能IDE的帮助下，可以降低软件腐化的速度，提升可维护性，且在重构时，强类型和静态类型检查会帮上大忙，甚至有了类型定义，会不经意间增加重构的频率（更安全、放心）。

- 从线上运行时质量上看，我们现在的SPA项目的很多bug都是由于一些调用方和被调用方（如组件模块间的协作、接口或函数的调用）的数据格式不匹配引起的，由于TS有编译期的静态检查，让我们的bug尽可能消灭在编译器，加上IDE有智能纠错，编码时就能提前感知bug的存在，我们的线上运行时质量会更为稳定可控。

## 从 JavaScript 到 TypeScript

对于老项目，由于TS兼容ES规范，所以可以比较方便的升级现有的JS（这里指ES6及以上）代码，逐渐的加类型注解，渐进式增强代码健壮性。迁移过程：

npm全局安装typescript包，并在工程根目录运行tsc --init，自动产生tsconfig.json文件。
默认的3个配置项：更多配置项说明

"target":"es5": 编译后代码的ES版本，还有es3，es2105等选项。
"module":"commonjs":编译后代码的模块化组织方式，还有amd，umd，es2015等选项。
"strict":true:严格校验，包含不能有没意义的any，null校验等选项。

初始化得到的tsconfig.json无需修改，增加"allowJs": true选项。

配置webpack配置，增加ts的loader，如awesome-typescript-loader。(如果是基于atool-build来构建的项目，则它内置了ts编译，这步省略)
loaders: [
	// All files with a '.ts' or '.tsx' extension will be handled by 'awesome-typescript-loader'.
	{ test: /\.tsx?$/, loader: "awesome-typescript-loader" }
]
复制代码

此时你可以写文件名为ts和tsx（React）后缀的代码了，它可以和现有的ES6代码共存，VSCode会自动校验这部分代码，webpack打包也没问题了。

逐渐的，开始打算重构以前的ES6代码为TS代码，只需将文件后缀改成ts(x)就行，就可以享受TS及IDE智能感知/纠错带来的好处。


### 成本对比

> 星多表示占优 一颗 ⭐️ 评分最低，五颗 ⭐️ 评分最高

|成本点|JavaScript（es）|TypeScript|说明|
|:-:|:-:|:-:|:-:|
|学习和踩坑成本|⭐️⭐️⭐️⭐️|⭐️⭐️⭐️|虽然是JS超集，但还是要学习TS本身及面向对象基础知识，开发环境搭建、使用中的问题和坑也需要自己趟，好在TS社区比较成熟，网上沉淀的资料很多|
|整体代码量|⭐️⭐️⭐️⭐️⭐️|⭐️⭐️⭐️|TS代码增加比较完善的类型定义的话整体代码量比原生ES多5%~10%左右|
|原生JS（标准ES、浏览器端、服务器端）|⭐️⭐️⭐️⭐️|⭐️⭐️⭐️⭐️⭐️|IDE内置了详尽的类型声明，可以智能提示方法和参数说明，提升了效率|
|依赖外部库（React、Lodash、Antd）|⭐️⭐️⭐️⭐️|⭐️⭐️⭐️⭐️⭐️|有TS类型声明库，IDE智能提示和分析，效率提升|
|内部公共库、模块|⭐️⭐️⭐️⭐️|⭐️⭐️⭐️⭐️⭐️|团队内部自行编写类型定义文件，有一定工作量，但开发效率可以有一些提升，逐步完善类型定义后，效率进一步提升|
|团队协作效率|⭐️|⭐️⭐️⭐️⭐️⭐️|对系统配置、外部接口、内部模块做类型定义后，实例对象属性就不能随意改了，每个被调用方负责自己的对外类型展现，调用者只需关心被调用方的类型，不需关心内部细节|
|代码可维护性|⭐️|⭐️⭐️⭐️⭐️⭐️|由于团队成员水平差异，和软件开发的特质（熵），长期迭代维护的项目总会遇到可维护性的问题，有了强类型约束和静态检查，以及智能IDE的帮助下，可以降低软件腐化的速度，提升可维护性，且在重构时，强类型和静态类型检查会帮上大忙，甚至有了类型定义，会不经意间增加重构的频率|
|运行时稳定性|⭐️|⭐️⭐️⭐️⭐️ ⭐️|由于TS有静态类型检查，很多bug都会被消灭在部署前|
